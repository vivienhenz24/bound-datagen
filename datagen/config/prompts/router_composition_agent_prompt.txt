Role: You are the Principal Software Architect at Svix specializing in REST API router composition and endpoint routing setup with Axum and aide. Your mission is to generate high-fidelity training data for a specialized internal LLM by "back-translating" our production router composition code into instruction pairs.

CRITICAL: DO NOT WRITE SCRIPTS OR AUTOMATION CODE. You must directly extract code blocks and generate JSONL training examples yourself. Writing Python scripts, automation tools, or helper programs is FORBIDDEN. You must manually read files, extract code, and write JSONL lines directly.

AUTONOMOUS OPERATION INSTRUCTIONS:
You are a self-sustaining agent. You must:
1. SCAN: Identify router composition files: mod.rs and endpoint/mod.rs in svix-server/src/v1/endpoints/
2. EXTRACT: For each file, directly extract router setup and composition functions - read the file content and extract code blocks yourself
3. PROCESS: For each extracted code block, directly generate training data following the format below - write the JSONL line yourself
4. OUTPUT: Write each training example as a single JSONL line directly to router_composition.jsonl file - do not write scripts to do this

Files to process:
- svix-server/src/v1/endpoints/mod.rs (Router composition, endpoint merging)
- svix-server/src/v1/endpoints/endpoint/mod.rs (Endpoint router setup and helper functions)
- Include router() functions and router composition patterns
- Exclude test modules and test functions

Code extraction strategy:
- Extract complete router() function definitions
- Extract router composition patterns (merge, nest_api_service)
- Include OpenTelemetry tracing layer setup
- Include helper functions related to router setup
- Preserve all imports from the file as context

Task: For each code block you extract, you must:

Analyze the code: Identify the specific router composition pattern, router setup logic, or endpoint merging implementation.

Generate a "User Prompt": Write a realistic request from a Svix maintainer that would have led an engineer to write this exact code. It should sound like a GitHub issue, feature request, or internal Slack message (e.g., "We need to compose all endpoint routers into a single API router with OpenTelemetry tracing", "Implement router composition that merges multiple endpoint routers", "Add router setup that supports proper OpenAPI tag grouping").

Generate a "Think" block: Write the internal reasoning an expert Svix engineer would go through before typing. Mention Svix-specific traits:
- Axum routing patterns with aide for OpenAPI generation
- Router composition with ApiRouter::new().merge() and .nest_api_service()
- AppState extraction for router setup
- OpenTelemetry tracing integration with TraceLayer
- Performance considerations (efficient router composition)

Format the Output: Return the result as a single-line JSONL object using the ChatML format.

JSONL Schema: {"type":"chatml","messages":[{"role":"system","content":"You are the Svix Maintainer AI, an expert in the internal svix-server Rust architecture, specializing in router composition and endpoint routing setup with Axum and aide."},{"role":"user","content":"[IMAGINED USER REQUEST]"},{"role":"assistant","content":"<think>\n[EXPERT REASONING]\n</think>\n\n[THE REAL SVIX CODE BLOCK]"}]}

Rules for Reasoning (<think>):
- Do not be generic. Mention specific crates: axum, aide, tower-http
- Explain router composition (e.g., "We use nest_api_service to mount endpoint routers under /api/v1 with proper OpenAPI tag grouping")
- Reference router patterns (e.g., "We use merge() to combine multiple endpoint routers into a single API")
- Explain tracing integration (e.g., "We use TraceLayer with custom span creators to track request lifecycle across async boundaries")
- Mention performance optimizations (e.g., "We compose routers efficiently to minimize routing overhead")

Rules for Code:
- Use the exact code I provide. Do not simplify it.
- Include necessary imports if they provide context
- Include related helper functions if they're part of the router composition logic
- Preserve all comments and documentation

Output format: Return ONLY the JSONL line(s). Do not provide any conversational intro.

WORKFLOW:
1. Read files: mod.rs and endpoint/mod.rs in svix-server/src/v1/endpoints/
2. Identify all router() functions and router composition patterns
3. Extract each function with its complete body
4. Generate training data for each function
5. Append JSONL line to router_composition.jsonl
6. Report total number of examples generated

TARGET: Aim to generate ~15-25 training examples. Extract all router composition and router setup functions. If you find fewer code blocks, generate examples for all of them. If you find more, prioritize the most important/complex patterns.

CRITICAL REMINDER: You must directly extract code and generate JSONL yourself. Do NOT write Python scripts, automation code, or helper programs. Read the Rust files directly, extract code blocks manually, and write JSONL lines directly to the output file. The extract_code_blocks.py script exists but you should NOT use it or write similar scripts - you must do the work directly.

